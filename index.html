<!DOCTYPE html>
<html>
<body>

<canvas id="myCanvas" width="500" height="500" style="border:1px solid #d3d3d3;">
Your browser does not support the HTML5 canvas tag.
</canvas>

<button id="create">Rysuj linie</button>
<button id="move">Przesuń punkty</button>
<button id="eraser">Gumka</button>
<input type="range" id="lineWidth" min="1" max="10">
<button id="ellipse">Elipsa</button>
<button id="rectangle">Prostokąt</button>
<button id="polygon">Wielokąt</button>

<script>
var c = document.getElementById("myCanvas");
var ctx = c.getContext("2d");

var shapes = [];
var selectedShapeIndex;
var movingPoint;
var creating = false;
var moving = false;
var erasing = false;
var shapeType = "";

ctx.lineWidth = 1;

c.onmousedown = function(e) {
  if (erasing) {
    shapes = shapes.filter(function(shape) {
      return !(shape.x <= e.clientX && e.clientX <= shape.x + shape.width &&
               shape.y <= e.clientY && e.clientY <= shape.y + shape.height);
    });
    redraw();
  } else if (creating) {
    var shape = {type: shapeType, x: e.clientX, y: e.clientY, width: 0, height: 0};
    shapes.push(shape);
    selectedShapeIndex = shapes.length - 1;
  }
};

c.onmousemove = function(e) {
  if (selectedShapeIndex !== -1) {
    var shape = shapes[selectedShapeIndex];
    shape.width = e.clientX - shape.x;
    shape.height = e.clientY - shape.y;
    redraw();
  }
};

c.onmouseup = function() {
  selectedShapeIndex = -1;
};

document.getElementById("create").onclick = function() {
  creating = true;
  moving = false;
  erasing = false;
};

document.getElementById("move").onclick = function() {
  creating = false;
  moving = true;
  erasing = false;
};

document.getElementById("eraser").onclick = function() {
  creating = false;
  moving = false;
  erasing = true;
};

document.getElementById("ellipse").onclick = function() {
  creating = true;
  moving = false;
  erasing = false;
  shapeType = "ellipse";
};

document.getElementById("rectangle").onclick = function() {
  creating = true;
  moving = false;
  erasing = false;
  shapeType = "rectangle";
};

document.getElementById("polygon").onclick = function() {
  creating = true;
  moving = false;
  erasing = false;
  shapeType = "polygon";
};

document.getElementById("lineWidth").onchange = function() {
  ctx.lineWidth = this.value;
};

function redraw() {
  ctx.clearRect(0, 0, c.width, c.height);
  shapes.forEach(function(shape) {
    ctx.beginPath();
    if (shape.type === "ellipse") {
      ctx.ellipse(shape.x + shape.width / 2, shape.y + shape.height / 2, Math.abs(shape.width / 2), Math.abs(shape.height / 2), 0, 0, Math.PI * 2);
    } else if (shape.type === "rectangle") {
      ctx.rect(shape.x, shape.y, shape.width, shape.height);
    } else if (shape.type === "polygon") {
      // W tym przykładzie wielokąt jest traktowany jako trójkąt
      ctx.moveTo(shape.x, shape.y);
      ctx.lineTo(shape.x + shape.width, shape.y);
      ctx.lineTo(shape.x + shape.width / 2, shape.y + shape.height);
      ctx.closePath();
    }
    ctx.stroke();
  });
}
</script>

</body>
</html>
